"use strict";(self.webpackChunk_typed_inject_website=self.webpackChunk_typed_inject_website||[]).push([[440],{9613:(e,t,n)=>{n.d(t,{Zo:()=>l,kt:()=>v});var r=n(9496);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var c=r.createContext({}),p=function(e){var t=r.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},l=function(e){var t=p(e.components);return r.createElement(c.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,a=e.originalType,c=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),u=p(n),d=i,v=u["".concat(c,".").concat(d)]||u[d]||m[d]||a;return n?r.createElement(v,o(o({ref:t},l),{},{components:n})):r.createElement(v,o({ref:t},l))}));function v(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var a=n.length,o=new Array(a);o[0]=d;var s={};for(var c in t)hasOwnProperty.call(t,c)&&(s[c]=t[c]);s.originalType=e,s[u]="string"==typeof e?e:i,o[1]=s;for(var p=2;p<a;p++)o[p]=n[p];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},6004:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>m,frontMatter:()=>a,metadata:()=>s,toc:()=>p});var r=n(1966),i=(n(9496),n(9613));const a={sidebar_position:6},o="Usage in JavaScript",s={unversionedId:"guide/services/usage-in-javascript",id:"guide/services/usage-in-javascript",title:"Usage in JavaScript",description:"TypeDI is primarily developed for use in TypeScript.",source:"@site/docs/guide/services/usage-in-javascript.md",sourceDirName:"guide/services",slug:"/guide/services/usage-in-javascript",permalink:"/typedi/docs/guide/services/usage-in-javascript",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/guide/services/usage-in-javascript.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{sidebar_position:6},sidebar:"tutorialSidebar",previous:{title:"Transient Services",permalink:"/typedi/docs/guide/services/transient-services"},next:{title:"HostContainer",permalink:"/typedi/docs/guide/services/host-container"}},c={},p=[{value:"<code>JSService</code> type",id:"jsservice-type",level:2},{value:"Function classes",id:"function-classes",level:2}],l={toc:p},u="wrapper";function m(e){let{components:t,...n}=e;return(0,i.kt)(u,(0,r.Z)({},l,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"usage-in-javascript"},"Usage in JavaScript"),(0,i.kt)("p",null,"TypeDI is primarily developed for use in TypeScript.\nHowever, to make it ",(0,i.kt)("em",{parentName:"p"},"easier")," to make use of it in JavaScript, a ",(0,i.kt)("a",{parentName:"p",href:"pathname:///api-reference/functions/JSService-1.html"},(0,i.kt)("inlineCode",{parentName:"a"},"JSService"))," function is provided."),(0,i.kt)("p",null,"As an example of how to use it, let's tweak the logging service we made in the ",(0,i.kt)("a",{parentName:"p",href:"/typedi/docs/examples/hello-world"},"Hello World! example"),":"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="src/log.service.js"',title:'"src/log.service.js"'},"import { JSService } from '@typed-inject/injector';\n\nexport const LogService = JSService(\n  [],\n  class LogService {\n    log(message) {\n      console.log(message);\n    }\n  }\n);\n")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="src/root.service.js"',title:'"src/root.service.js"'},"import { Service } from '@typed-inject/injector';\n\nexport const RootService = JSService(\n  [LogService],\n  class RootService {\n    public constructor(private logger) {}\n\n    run() {\n      this.logger.log('Hello World!');\n    }\n  }\n);\n")),(0,i.kt)("admonition",{type:"caution"},(0,i.kt)("p",{parentName:"admonition"},"As with ",(0,i.kt)("a",{parentName:"p",href:"pathname:///api-reference/functions/Service.html"},(0,i.kt)("inlineCode",{parentName:"a"},"Service")),", don't forget to place any dependencies your service requires in the array.\nOtherwise, TypeDI won't know your service requires them, and won't pass them in as arguments.")),(0,i.kt)("p",null,"As you can see, the API is quite similar to its TypeScript-friendly equivalent.\nWith our changes, the example above will run in plain JavaScript with no problems."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"But we're not done yet"),"."),(0,i.kt)("h2",{id:"jsservice-type"},(0,i.kt)("inlineCode",{parentName:"h2"},"JSService")," type"),(0,i.kt)("p",null,"In the examples above, TypeScript doesn't interpret each service as a class. That means the following will fail:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="src/example.ts"',title:'"src/example.ts"'},"import { LogService } from './log.service';\n// highlight-next-line-error\nconst logService: LogService = new LogService();\n// highlight-error-comment-start\n//    ^^^^^^^^^^\n//    'LogService' refers to a value, but is being used as a type here. Did you mean 'typeof MyService'?\n// highlight-error-comment-end\n")),(0,i.kt)("p",null,"If you're type-checking JavaScript with TypeScript, that can quickly become a problem.\nThat's where the ",(0,i.kt)("inlineCode",{parentName:"p"},"JSService")," ",(0,i.kt)("em",{parentName:"p"},"type")," comes in."),(0,i.kt)("p",null,"Cleverly, the ",(0,i.kt)("inlineCode",{parentName:"p"},"JSService")," import is actually ",(0,i.kt)("em",{parentName:"p"},"two")," imports: one for the function implementation, and another for a type.\nThe type allows you to wrap the service in the type to elide type errors, like so:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts",metastring:'title="src/example.ts"',title:'"src/example.ts"'},"import { JSService } from '@typed-inject/injector';\nimport { LogService } from './log.service';\n\nconst logService: JSService<typeof LogService> = new LogService();\n")),(0,i.kt)("admonition",{type:"note"},(0,i.kt)("p",{parentName:"admonition"},"Unfortunately, due to a limitation in TypeScript, it's not currently possible to export the equivalent ",(0,i.kt)("inlineCode",{parentName:"p"},"JSService"),"-wrapped\ntype from a ",(0,i.kt)("inlineCode",{parentName:"p"},".js")," file. See ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/microsoft/TypeScript/issues/48104"},"microsoft/TypeScript#48104"),".")),(0,i.kt)("h2",{id:"function-classes"},"Function classes"),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"JSService")," function also supports functional classes as opposed to ES6 ones."),(0,i.kt)("p",null,"This lets us take advantage of TypeDI in ES5 environments without any transpilation steps."),(0,i.kt)("p",null,"As an example, let's change the ",(0,i.kt)("inlineCode",{parentName:"p"},"LogService")," we made above to the following:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-js",metastring:'title="src/log.service.js"',title:'"src/log.service.js"'},"import { JSService } from '@typed-inject/injector';\n\nexport const LogService = JSService([], function LogService() {});\n\nLogService.prototype.log = function (message) {\n  console.log(message);\n};\n")),(0,i.kt)("p",null,"We've now moved our methods outside of the main call to ",(0,i.kt)("inlineCode",{parentName:"p"},"JSService"),".\nInstead, they reside below it."),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("p",{parentName:"admonition"},"It's generally recommended to use ES6 classes wherever possible, as they provide\na better experience in editors such ",(0,i.kt)("a",{parentName:"p",href:"https://code.visualstudio.com/"},"Visual Studio Code"),". The example above might need additional typing in adjacent ",(0,i.kt)("inlineCode",{parentName:"p"},".d.ts")," files."),(0,i.kt)("p",{parentName:"admonition"},"As of currently, the methods in the above service are not automatically inferred by\nTypeScript. Therefore, when used, they are of type ",(0,i.kt)("inlineCode",{parentName:"p"},"any"),".")))}m.isMDXComponent=!0}}]);